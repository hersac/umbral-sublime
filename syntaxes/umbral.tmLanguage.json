{
  "scopeName": "source.umbral",
  "patterns": [
    { "include": "#comentarios" },
    { "include": "#strings" },
    { "include": "#palabrasClave" },
    { "include": "#modificadores" },
    { "include": "#operadores" },
    { "include": "#tipos" },
    { "include": "#numeros" },
    { "include": "#booleanos" },
    { "include": "#llaves" },
    { "include": "#llamadas_funciones" },
    { "include": "#funciones_builtin" }
  ],
  "repository": {
    "comentarios": {
      "patterns": [
        {
          "match": "!!.*$",
          "name": "comment.line.double-exclamation.umbral"
        }
      ]
    },

    "strings": {
      "patterns": [
        {
          "begin": "'''",
          "end": "'''",
          "name": "string.quoted.triple.umbral",
          "patterns": [
            {
              "match": "\\\\.",
              "name": "constant.character.escape.umbral"
            },
            {
              "match": "&[a-zA-Z_][a-zA-Z0-9_]*((\\.[a-zA-Z_][a-zA-Z0-9_]*)|(\\([^\\)]*\\))|(\\[[^\\]]*\\]))*",
              "name": "constant.character.escape.umbral"
            }
          ]
        },
        {
          "begin": "'",
          "end": "'",
          "name": "string.quoted.single.umbral"
        },
        {
          "begin": "\"",
          "end": "\"",
          "name": "string.quoted.double.umbral",
          "patterns": [
            {
              "match": "\\\\.",
              "name": "constant.character.escape.umbral"
            },
            {
              "match": "&[a-zA-Z_][a-zA-Z0-9_]*((\\.[a-zA-Z_][a-zA-Z0-9_]*)|(\\([^\\)]*\\))|(\\[[^\\]]*\\]))*",
              "name": "constant.character.escape.umbral"
            }
          ]
        }
      ]
    },

    "palabrasClave": {
      "patterns": [
        {
          "match": "\\b(i|ie|e|wh|r|th|n|out|equip|origin|as)\\b",
          "name": "keyword.control.umbral"
        },
        {
          "match": "\\b(sw|ca|def):",
          "name": "keyword.control.switch.umbral"
        },
        {
          "match": "\\b(ext|imp|in):",
          "name": "keyword.other.oop.umbral"
        },
        {
          "match": "\\b(v|c|f|fo|fe|cs|pr|pu):",
          "name": "keyword.declaration.umbral"
        }
      ]
    },

    "modificadores": {
      "patterns": [
        {
          "match": "\\b(pu|pr)\\b",
          "name": "storage.modifier.umbral"
        }
      ]
    },

    "operadores": {
      "patterns": [
        {
          "match": "(->|\\+|\\-|\\*|\\/|%|==|!=|<=|>=|<|>|&&|\\|\\||!|=)",
          "name": "keyword.operator.umbral"
        },
        {
          "match": "&(?![a-zA-Z_])",
          "name": "keyword.operator.spread.umbral"
        }
      ]
    },

    "tipos": {
      "patterns": [
        {
          "match": "\\b(Int|Str|Flo|Bool|Void)\\b",
          "name": "support.type.primitive.umbral"
        },
        {
          "match": "\\[\\]\\[\\]",
          "name": "support.type.array.umbral"
        },
        {
          "match": "\\[\\]",
          "name": "support.type.array.umbral"
        }
      ]
    },

    "numeros": {
      "patterns": [
        {
          "match": "\\b[0-9]+(\\.[0-9]+)?\\b",
          "name": "constant.numeric.umbral"
        }
      ]
    },

    "booleanos": {
      "patterns": [
        {
          "match": "\\b(true|false)\\b",
          "name": "constant.language.boolean.umbral"
        }
      ]
    },

    "llaves": {
      "patterns": [
        {
          "match": "[\\{\\}]",
          "name": "punctuation.definition.block.umbral"
        },
        {
          "match": "[\\[\\]]",
          "name": "punctuation.definition.array.umbral"
        }
      ]
    },

    "llamadas_funciones": {
      "patterns": [
        {
          "match": "([a-zA-Z_][a-zA-Z0-9_]*)\\.([a-zA-Z_][a-zA-Z0-9_]*)(?=\\s*\\()",
          "captures": {
            "2": {
              "name": "entity.name.function.umbral"
            }
          }
        },
        {
          "match": "\\b([a-zA-Z_][a-zA-Z0-9_]*)(?=\\s*\\()",
          "name": "entity.name.function.umbral"
        }
      ]
    },

    "funciones_builtin": {
      "patterns": [
        {
          "match": "\\b(tprint)\\b",
          "name": "support.function.builtin.umbral"
        },
        {
          "match": "\\.length\\b",
          "name": "support.variable.property.umbral"
        }
      ]
    }
  }
}
